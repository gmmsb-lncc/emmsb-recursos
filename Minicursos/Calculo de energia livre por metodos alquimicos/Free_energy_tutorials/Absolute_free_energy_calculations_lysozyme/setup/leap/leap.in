#load force fileds and ligand parameter files 
source leaprc.protein.ff19SB
source leaprc.water.opc 
source leaprc.gaff2
loadamberparams bnz.frcmod

#load structure files for the protein and ligand
BNZ = loadmol2 bnz_bcc.mol2
prot = loadpdb LYZ.pdb
wat = loadpdb water.pdb

#generate topology and restart files for the complex decharging step
decharge = combine { prot BNZ BNZ wat }
solvateoct decharge OPCBOX 10 0.75
addionsrand decharge Na+ 0
addionsrand decharge Cl- 0
saveamberparm decharge lyz_bnz_dech.parm7 lyz_bnz_dech.rst7 
savepdb decharge lyz_bnz_dech.pdb

#generate topology and restart files for the ligand decharging step
ldecharge = combine { BNZ BNZ }
solvateoct ldecharge OPCBOX 18 0.75
saveamberparm ldecharge bnz_dech.parm7 bnz_dech.rst7
savepdb ldecharge bnz_dech.pdb

#generate topology and restart files for the complex van der Waals transformation
vdw = combine { prot BNZ wat }
solvateoct vdw OPCBOX 10 0.75 
addionsrand vdw Na+ 0
addionsrand vdw Cl- 0 
saveamberparm vdw lyz_bnz_vdw.parm7 lyz_bnz_vdw.rst7
savepdb vdw lyz_bnz_vdw.pdb 

#generate topology and restart files for the ligand van der Waals transformation
solvateoct BNZ OPCBOX 18 0.75
saveamberparm BNZ bnz_vdw.parm7 bnz_vdw.rst7
savepdb BNZ bnz_vdw.pdb

#check net charges for the generated complexes
charge decharge
charge vdw 

quit

 
